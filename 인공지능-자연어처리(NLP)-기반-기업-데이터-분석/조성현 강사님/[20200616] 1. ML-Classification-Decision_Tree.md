# [머신러닝]



## 1. 분류(Classification)



### 1.2. Decision Tree



  구분선 : decision boundary. 의사결정선.



 

의사결정선을 긋는다. 새로운 데이터가 어디에 가까운지 결정하기 위해 의사결정선을 긋는다. 가장 잘 분류할 때까지 의사결정선을 계속해서 그어 나간다. 

새로운 데이터가 들어왔을 때 의사결정선을 따라 경계별로 나누어 나간다. 따라왔더니, 마지막 단계에서 분류될 확률이 몇이 되더라!

* 분기: 의사결정나무 나누어진다.
* 리프 노드: 마지막 노드.



model.build

model.fit --> 트리 생성. 트리를 만들어 준다.

model.predict --> 새로운 데이터에 대해 predict



 어떻게 트리를 잘 만들 수 있을까? 최적의 분할 선택 기준. 분리 기준. 분리의 선을 어디에 긋는 게 좋을까. 분할 선택의 기준이 필요하다!! 



그 기준으로 분할했을 때 왼쪽과 오른쪽을 비교해서 순도가 얼마나 높은지를 기준으로 분리 기준을 결정한다. 순도나 불순도를 측정하는 방법으로 두 가지가 있다.

- 엔트로피: 크로스 엔트로피 나올 때 자세히 정리. 공식이 어떻다는 것만 알고 넘어 가자. p는 확률, i는 1부터 c까지의  클래스.
- 지니 지수



 지니 지수 계산 및 비교



가중평균을 왜 하냐? 점의 개수에 따라서 순도가 달라질 수 있따. 아예 하나 있는 쪽에 그었다고 생각해봐. 데이터 1개 있으면 순도가 크잖아. 데이터 너무 조금 해놓고 순도 좋으니까 좋은거다! 라고 말하면 안 되죠.



지니계수 계싼  -- 원래 엔트로피 계쑤도 있는데 그건 나중에 하고 여기서는 지니 계쑤를 알아보도록 합시다!





정보량 계싼 부분 사라졌다 ㅠㅠㅠㅠ



무수히 많ㅇ느 것을 다 해볼 수는 없고 퀀타일 정도로 잘라서 초기 분할 결정.



초기 분할 왼 vs 오. 위 vs 아.



초기분할 이후 나눌 때에도 계속해서 마찬가지. 다음에도 어떻게 자르는 게 더 좋을지를 계속해서 이런 식으로 결정한다. 계속 반복합니다.







파라미터!!!?!/1?



max_depth None이면 pure해질 때까지 가죠. 그렇다면! 1개 남을 때까지 가니까 pure해진다.





질문



fit 단계에서 많은 일을 한다. 학습 데이터를 이용해서 학습 데이터로 트리를 만든다. 트리를 만들 때 앞에서 썼던 지니나 엔트로피를 가지고 분할 기준을 만든다.



실습







과적합 문제



|                             Gini                             |                           Entropy                            |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| ![image-20200616171057942](images/image-20200616171057942.png) | ![image-20200616171106516](images/image-20200616171106516.png) |





predict 하는 과정에서  트레인 데이터로 측정한 정확도는 높을 수밖에 없다. 자기 데이터로 트리 구성해 놓고 자기 데이터를 대입하면 잘 맞추겠지, 당연히. 이게 일반적인 상황. tree depth가 깊어질수록, 무한해질수록, 트리를 어디까지 만드냐면, 맨 끝에 leaf node라고 하는 애가 최종적으로 1개씩 남을 때까지.

 데이터가 딸랑 하나면 당연히 순도가 높다. 불순도가 없다. 뎁스가 깊으면 깊을수록 학습 데이터는 아주 정확히 맞춘다. 그래서 100프로 가까이 나온다. 뎁스가 깊어질수록. 그런데 테스트 데이터는 그 정도 선까지 못 간다. 뎁스가 깊을수록 좋을까? 생각해보면, 뎁스가 깊다는 얘기는 학습 데이터는 설명을 잘 하는데, 시험 데이터는 잘 못 맞춘다는 말.

학습 데이터를 알고리즘이 달달 외워 버림. 달달 오웠으니까 그 데이터는 잘 맞춤, 그런데 외우지 않은, 처음 보는 데이터는 잘 못 맞추는 것.

적절한 뎁스가 어디인지, 시험 데이터를 잘 맞추는 데이터를 찾아야 한다.





 income 데이터로 한 예시를 봐도 그렇다. 뎁스가 깊어질수록 트레인 데이터에 대한 게



![image-20200616174558225](images/image-20200616174558225.png)



# 가지치기

pruning

혹은 뎁스를 최대로 트리를 만든 다음에, 미텡서부터 트리를 잘라내는 방식도 있다. 최대한 기핑 만들었다가 거꾸로 올ㄹ가면서 가지치기를 한다.

